System.register(["jimu-core","jimu-for-builder/templates"],(function(e,t){var n={},r={};return{setters:[function(e){n.Immutable=e.Immutable,n.SessionManager=e.SessionManager,n.USER_SETTING_FILE_KEY=e.USER_SETTING_FILE_KEY,n.appConfigUtils=e.appConfigUtils,n.esri=e.esri,n.getAppStore=e.getAppStore,n.i18n=e.i18n,n.moduleLoader=e.moduleLoader,n.portalUrlUtils=e.portalUrlUtils,n.sharedThemeUtils=e.sharedThemeUtils,n.urlUtils=e.urlUtils,n.utils=e.utils,n.version=e.version},function(e){r.TemplateType=e.TemplateType,r.getTemplateConfig=e.getTemplateConfig}],execute:function(){e((()=>{var e={9593:(e,t,n)=>{"use strict";const r=n(4411),i=Symbol("max"),o=Symbol("length"),s=Symbol("lengthCalculator"),a=Symbol("allowStale"),l=Symbol("maxAge"),u=Symbol("dispose"),c=Symbol("noDisposeOnSet"),d=Symbol("lruList"),h=Symbol("cache"),p=Symbol("updateAgeOnGet"),f=()=>1,v=(e,t,n)=>{const r=e[h].get(t);if(r){const t=r.value;if(m(e,t)){if(y(e,r),!e[a])return}else n&&(e[p]&&(r.value.now=Date.now()),e[d].unshiftNode(r));return t.value}},m=(e,t)=>{if(!t||!t.maxAge&&!e[l])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[l]&&n>e[l]},g=e=>{if(e[o]>e[i])for(let t=e[d].tail;e[o]>e[i]&&null!==t;){const n=t.prev;y(e,t),t=n}},y=(e,t)=>{if(t){const n=t.value;e[u]&&e[u](n.key,n.value),e[o]-=n.length,e[h].delete(n.key),e[d].removeNode(t)}};class E{constructor(e,t,n,r,i){this.key=e,this.value=t,this.length=n,this.now=r,this.maxAge=i||0}}const S=(e,t,n,r)=>{let i=n.value;m(e,i)&&(y(e,n),e[a]||(i=void 0)),i&&t.call(r,i.value,i.key,e)};e.exports=class{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[i]=e.max||1/0;const t=e.length||f;if(this[s]="function"!=typeof t?f:t,this[a]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[l]=e.maxAge||0,this[u]=e.dispose,this[c]=e.noDisposeOnSet||!1,this[p]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[i]=e||1/0,g(this)}get max(){return this[i]}set allowStale(e){this[a]=!!e}get allowStale(){return this[a]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[l]=e,g(this)}get maxAge(){return this[l]}set lengthCalculator(e){"function"!=typeof e&&(e=f),e!==this[s]&&(this[s]=e,this[o]=0,this[d].forEach((e=>{e.length=this[s](e.value,e.key),this[o]+=e.length}))),g(this)}get lengthCalculator(){return this[s]}get length(){return this[o]}get itemCount(){return this[d].length}rforEach(e,t){t=t||this;for(let n=this[d].tail;null!==n;){const r=n.prev;S(this,e,n,t),n=r}}forEach(e,t){t=t||this;for(let n=this[d].head;null!==n;){const r=n.next;S(this,e,n,t),n=r}}keys(){return this[d].toArray().map((e=>e.key))}values(){return this[d].toArray().map((e=>e.value))}reset(){this[u]&&this[d]&&this[d].length&&this[d].forEach((e=>this[u](e.key,e.value))),this[h]=new Map,this[d]=new r,this[o]=0}dump(){return this[d].map((e=>!m(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)})).toArray().filter((e=>e))}dumpLru(){return this[d]}set(e,t,n){if((n=n||this[l])&&"number"!=typeof n)throw new TypeError("maxAge must be a number");const r=n?Date.now():0,a=this[s](t,e);if(this[h].has(e)){if(a>this[i])return y(this,this[h].get(e)),!1;const s=this[h].get(e).value;return this[u]&&(this[c]||this[u](e,s.value)),s.now=r,s.maxAge=n,s.value=t,this[o]+=a-s.length,s.length=a,this.get(e),g(this),!0}const p=new E(e,t,a,r,n);return p.length>this[i]?(this[u]&&this[u](e,t),!1):(this[o]+=p.length,this[d].unshift(p),this[h].set(e,this[d].head),g(this),!0)}has(e){if(!this[h].has(e))return!1;const t=this[h].get(e).value;return!m(this,t)}get(e){return v(this,e,!0)}peek(e){return v(this,e,!1)}pop(){const e=this[d].tail;return e?(y(this,e),e.value):null}del(e){y(this,this[h].get(e))}load(e){this.reset();const t=Date.now();for(let n=e.length-1;n>=0;n--){const r=e[n],i=r.e||0;if(0===i)this.set(r.k,r.v);else{const e=i-t;e>0&&this.set(r.k,r.v,e)}}}prune(){this[h].forEach(((e,t)=>v(this,t,!1)))}}},2257:(e,t,n)=>{const r=Symbol("SemVer ANY");class i{static get ANY(){return r}constructor(e,t){if(t=o(t),e instanceof i){if(e.loose===!!t.loose)return e;e=e.value}u("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===r?this.value="":this.value=this.operator+this.semver.version,u("comp",this)}parse(e){const t=this.options.loose?s[a.COMPARATORLOOSE]:s[a.COMPARATOR],n=e.match(t);if(!n)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==n[1]?n[1]:"","="===this.operator&&(this.operator=""),n[2]?this.semver=new c(n[2],this.options.loose):this.semver=r}toString(){return this.value}test(e){if(u("Comparator.test",e,this.options.loose),this.semver===r||e===r)return!0;if("string"==typeof e)try{e=new c(e,this.options)}catch(e){return!1}return l(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof i))throw new TypeError("a Comparator is required");if(t&&"object"==typeof t||(t={loose:!!t,includePrerelease:!1}),""===this.operator)return""===this.value||new d(e.value,t).test(this.value);if(""===e.operator)return""===e.value||new d(this.value,t).test(e.semver);const n=!(">="!==this.operator&&">"!==this.operator||">="!==e.operator&&">"!==e.operator),r=!("<="!==this.operator&&"<"!==this.operator||"<="!==e.operator&&"<"!==e.operator),o=this.semver.version===e.semver.version,s=!(">="!==this.operator&&"<="!==this.operator||">="!==e.operator&&"<="!==e.operator),a=l(this.semver,"<",e.semver,t)&&(">="===this.operator||">"===this.operator)&&("<="===e.operator||"<"===e.operator),u=l(this.semver,">",e.semver,t)&&("<="===this.operator||"<"===this.operator)&&(">="===e.operator||">"===e.operator);return n||r||o&&s||a||u}}e.exports=i;const o=n(2893),{re:s,t:a}=n(5765),l=n(7539),u=n(4225),c=n(6376),d=n(6902)},6902:(e,t,n)=>{class r{constructor(e,t){if(t=o(t),e instanceof r)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new r(e.raw,t);if(e instanceof s)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${e}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!f(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&v(e[0])){this.set=[e];break}}this.format()}format(){return this.range=this.set.map((e=>e.join(" ").trim())).join("||").trim(),this.range}toString(){return this.range}parseRange(e){e=e.trim();const t=`parseRange:${Object.keys(this.options).join(",")}:${e}`,n=i.get(t);if(n)return n;const r=this.options.loose,o=r?u[c.HYPHENRANGELOOSE]:u[c.HYPHENRANGE];e=e.replace(o,O(this.options.includePrerelease)),a("hyphen replace",e),e=e.replace(u[c.COMPARATORTRIM],d),a("comparator trim",e,u[c.COMPARATORTRIM]),e=(e=(e=e.replace(u[c.TILDETRIM],h)).replace(u[c.CARETTRIM],p)).split(/\s+/).join(" ");const l=r?u[c.COMPARATORLOOSE]:u[c.COMPARATOR],v=e.split(" ").map((e=>g(e,this.options))).join(" ").split(/\s+/).map((e=>R(e,this.options))).filter(this.options.loose?e=>!!e.match(l):()=>!0).map((e=>new s(e,this.options))),m=(v.length,new Map);for(const e of v){if(f(e))return[e];m.set(e.value,e)}m.size>1&&m.has("")&&m.delete("");const y=[...m.values()];return i.set(t,y),y}intersects(e,t){if(!(e instanceof r))throw new TypeError("a Range is required");return this.set.some((n=>m(n,t)&&e.set.some((e=>m(e,t)&&n.every((n=>e.every((e=>n.intersects(e,t)))))))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new l(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(T(this.set[t],e,this.options))return!0;return!1}}e.exports=r;const i=new(n(9593))({max:1e3}),o=n(2893),s=n(2257),a=n(4225),l=n(6376),{re:u,t:c,comparatorTrimReplace:d,tildeTrimReplace:h,caretTrimReplace:p}=n(5765),f=e=>"<0.0.0-0"===e.value,v=e=>""===e.value,m=(e,t)=>{let n=!0;const r=e.slice();let i=r.pop();for(;n&&r.length;)n=r.every((e=>i.intersects(e,t))),i=r.pop();return n},g=(e,t)=>(a("comp",e,t),e=w(e,t),a("caret",e),e=E(e,t),a("tildes",e),e=$(e,t),a("xrange",e),e=P(e,t),a("stars",e),e),y=e=>!e||"x"===e.toLowerCase()||"*"===e,E=(e,t)=>e.trim().split(/\s+/).map((e=>S(e,t))).join(" "),S=(e,t)=>{const n=t.loose?u[c.TILDELOOSE]:u[c.TILDE];return e.replace(n,((t,n,r,i,o)=>{let s;return a("tilde",e,t,n,r,i,o),y(n)?s="":y(r)?s=`>=${n}.0.0 <${+n+1}.0.0-0`:y(i)?s=`>=${n}.${r}.0 <${n}.${+r+1}.0-0`:o?(a("replaceTilde pr",o),s=`>=${n}.${r}.${i}-${o} <${n}.${+r+1}.0-0`):s=`>=${n}.${r}.${i} <${n}.${+r+1}.0-0`,a("tilde return",s),s}))},w=(e,t)=>e.trim().split(/\s+/).map((e=>I(e,t))).join(" "),I=(e,t)=>{a("caret",e,t);const n=t.loose?u[c.CARETLOOSE]:u[c.CARET],r=t.includePrerelease?"-0":"";return e.replace(n,((t,n,i,o,s)=>{let l;return a("caret",e,t,n,i,o,s),y(n)?l="":y(i)?l=`>=${n}.0.0${r} <${+n+1}.0.0-0`:y(o)?l="0"===n?`>=${n}.${i}.0${r} <${n}.${+i+1}.0-0`:`>=${n}.${i}.0${r} <${+n+1}.0.0-0`:s?(a("replaceCaret pr",s),l="0"===n?"0"===i?`>=${n}.${i}.${o}-${s} <${n}.${i}.${+o+1}-0`:`>=${n}.${i}.${o}-${s} <${n}.${+i+1}.0-0`:`>=${n}.${i}.${o}-${s} <${+n+1}.0.0-0`):(a("no pr"),l="0"===n?"0"===i?`>=${n}.${i}.${o}${r} <${n}.${i}.${+o+1}-0`:`>=${n}.${i}.${o}${r} <${n}.${+i+1}.0-0`:`>=${n}.${i}.${o} <${+n+1}.0.0-0`),a("caret return",l),l}))},$=(e,t)=>(a("replaceXRanges",e,t),e.split(/\s+/).map((e=>A(e,t))).join(" ")),A=(e,t)=>{e=e.trim();const n=t.loose?u[c.XRANGELOOSE]:u[c.XRANGE];return e.replace(n,((n,r,i,o,s,l)=>{a("xRange",e,n,r,i,o,s,l);const u=y(i),c=u||y(o),d=c||y(s),h=d;return"="===r&&h&&(r=""),l=t.includePrerelease?"-0":"",u?n=">"===r||"<"===r?"<0.0.0-0":"*":r&&h?(c&&(o=0),s=0,">"===r?(r=">=",c?(i=+i+1,o=0,s=0):(o=+o+1,s=0)):"<="===r&&(r="<",c?i=+i+1:o=+o+1),"<"===r&&(l="-0"),n=`${r+i}.${o}.${s}${l}`):c?n=`>=${i}.0.0${l} <${+i+1}.0.0-0`:d&&(n=`>=${i}.${o}.0${l} <${i}.${+o+1}.0-0`),a("xRange return",n),n}))},P=(e,t)=>(a("replaceStars",e,t),e.trim().replace(u[c.STAR],"")),R=(e,t)=>(a("replaceGTE0",e,t),e.trim().replace(u[t.includePrerelease?c.GTE0PRE:c.GTE0],"")),O=e=>(t,n,r,i,o,s,a,l,u,c,d,h,p)=>`${n=y(r)?"":y(i)?`>=${r}.0.0${e?"-0":""}`:y(o)?`>=${r}.${i}.0${e?"-0":""}`:s?`>=${n}`:`>=${n}${e?"-0":""}`} ${l=y(u)?"":y(c)?`<${+u+1}.0.0-0`:y(d)?`<${u}.${+c+1}.0-0`:h?`<=${u}.${c}.${d}-${h}`:e?`<${u}.${c}.${+d+1}-0`:`<=${l}`}`.trim(),T=(e,t,n)=>{for(let n=0;n<e.length;n++)if(!e[n].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(let n=0;n<e.length;n++)if(a(e[n].semver),e[n].semver!==s.ANY&&e[n].semver.prerelease.length>0){const r=e[n].semver;if(r.major===t.major&&r.minor===t.minor&&r.patch===t.patch)return!0}return!1}return!0}},6376:(e,t,n)=>{const r=n(4225),{MAX_LENGTH:i,MAX_SAFE_INTEGER:o}=n(3295),{re:s,t:a}=n(5765),l=n(2893),{compareIdentifiers:u}=n(6742);class c{constructor(e,t){if(t=l(t),e instanceof c){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid Version: ${e}`);if(e.length>i)throw new TypeError(`version is longer than ${i} characters`);r("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?s[a.LOOSE]:s[a.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>o||this.major<0)throw new TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<o)return t}return e})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(r("SemVer.compare",this.version,this.options,e),!(e instanceof c)){if("string"==typeof e&&e===this.version)return 0;e=new c(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof c||(e=new c(e,this.options)),u(this.major,e.major)||u(this.minor,e.minor)||u(this.patch,e.patch)}comparePre(e){if(e instanceof c||(e=new c(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],i=e.prerelease[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return u(n,i)}while(++t)}compareBuild(e){e instanceof c||(e=new c(e,this.options));let t=0;do{const n=this.build[t],i=e.build[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return u(n,i)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{let e=this.prerelease.length;for(;--e>=0;)"number"==typeof this.prerelease[e]&&(this.prerelease[e]++,e=-2);-1===e&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}}e.exports=c},3507:(e,t,n)=>{const r=n(3959);e.exports=(e,t)=>{const n=r(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null}},7539:(e,t,n)=>{const r=n(8718),i=n(1194),o=n(1312),s=n(5903),a=n(1544),l=n(2056);e.exports=(e,t,n,u)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e===n;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return r(e,n,u);case"!=":return i(e,n,u);case">":return o(e,n,u);case">=":return s(e,n,u);case"<":return a(e,n,u);case"<=":return l(e,n,u);default:throw new TypeError(`Invalid operator: ${t}`)}}},9038:(e,t,n)=>{const r=n(6376),i=n(3959),{re:o,t:s}=n(5765);e.exports=(e,t)=>{if(e instanceof r)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let n=null;if((t=t||{}).rtl){let t;for(;(t=o[s.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length);)n&&t.index+t[0].length===n.index+n[0].length||(n=t),o[s.COERCERTL].lastIndex=t.index+t[1].length+t[2].length;o[s.COERCERTL].lastIndex=-1}else n=e.match(o[s.COERCE]);return null===n?null:i(`${n[2]}.${n[3]||"0"}.${n[4]||"0"}`,t)}},8880:(e,t,n)=>{const r=n(6376);e.exports=(e,t,n)=>{const i=new r(e,n),o=new r(t,n);return i.compare(o)||i.compareBuild(o)}},7880:(e,t,n)=>{const r=n(6269);e.exports=(e,t)=>r(e,t,!0)},6269:(e,t,n)=>{const r=n(6376);e.exports=(e,t,n)=>new r(e,n).compare(new r(t,n))},2378:(e,t,n)=>{const r=n(3959),i=n(8718);e.exports=(e,t)=>{if(i(e,t))return null;{const n=r(e),i=r(t),o=n.prerelease.length||i.prerelease.length,s=o?"pre":"",a=o?"prerelease":"";for(const e in n)if(("major"===e||"minor"===e||"patch"===e)&&n[e]!==i[e])return s+e;return a}}},8718:(e,t,n)=>{const r=n(6269);e.exports=(e,t,n)=>0===r(e,t,n)},1312:(e,t,n)=>{const r=n(6269);e.exports=(e,t,n)=>r(e,t,n)>0},5903:(e,t,n)=>{const r=n(6269);e.exports=(e,t,n)=>r(e,t,n)>=0},253:(e,t,n)=>{const r=n(6376);e.exports=(e,t,n,i)=>{"string"==typeof n&&(i=n,n=void 0);try{return new r(e,n).inc(t,i).version}catch(e){return null}}},1544:(e,t,n)=>{const r=n(6269);e.exports=(e,t,n)=>r(e,t,n)<0},2056:(e,t,n)=>{const r=n(6269);e.exports=(e,t,n)=>r(e,t,n)<=0},8679:(e,t,n)=>{const r=n(6376);e.exports=(e,t)=>new r(e,t).major},7789:(e,t,n)=>{const r=n(6376);e.exports=(e,t)=>new r(e,t).minor},1194:(e,t,n)=>{const r=n(6269);e.exports=(e,t,n)=>0!==r(e,t,n)},3959:(e,t,n)=>{const{MAX_LENGTH:r}=n(3295),{re:i,t:o}=n(5765),s=n(6376),a=n(2893);e.exports=(e,t)=>{if(t=a(t),e instanceof s)return e;if("string"!=typeof e)return null;if(e.length>r)return null;if(!(t.loose?i[o.LOOSE]:i[o.FULL]).test(e))return null;try{return new s(e,t)}catch(e){return null}}},2358:(e,t,n)=>{const r=n(6376);e.exports=(e,t)=>new r(e,t).patch},7559:(e,t,n)=>{const r=n(3959);e.exports=(e,t)=>{const n=r(e,t);return n&&n.prerelease.length?n.prerelease:null}},9795:(e,t,n)=>{const r=n(6269);e.exports=(e,t,n)=>r(t,e,n)},3657:(e,t,n)=>{const r=n(8880);e.exports=(e,t)=>e.sort(((e,n)=>r(n,e,t)))},5712:(e,t,n)=>{const r=n(6902);e.exports=(e,t,n)=>{try{t=new r(t,n)}catch(e){return!1}return t.test(e)}},1100:(e,t,n)=>{const r=n(8880);e.exports=(e,t)=>e.sort(((e,n)=>r(e,n,t)))},6397:(e,t,n)=>{const r=n(3959);e.exports=(e,t)=>{const n=r(e,t);return n?n.version:null}},1249:(e,t,n)=>{const r=n(5765);e.exports={re:r.re,src:r.src,tokens:r.t,SEMVER_SPEC_VERSION:n(3295).SEMVER_SPEC_VERSION,SemVer:n(6376),compareIdentifiers:n(6742).compareIdentifiers,rcompareIdentifiers:n(6742).rcompareIdentifiers,parse:n(3959),valid:n(6397),clean:n(3507),inc:n(253),diff:n(2378),major:n(8679),minor:n(7789),patch:n(2358),prerelease:n(7559),compare:n(6269),rcompare:n(9795),compareLoose:n(7880),compareBuild:n(8880),sort:n(1100),rsort:n(3657),gt:n(1312),lt:n(1544),eq:n(8718),neq:n(1194),gte:n(5903),lte:n(2056),cmp:n(7539),coerce:n(9038),Comparator:n(2257),Range:n(6902),satisfies:n(5712),toComparators:n(1042),maxSatisfying:n(5775),minSatisfying:n(1657),minVersion:n(5316),validRange:n(9042),outside:n(6826),gtr:n(7606),ltr:n(32),intersects:n(2937),simplifyRange:n(7908),subset:n(799)}},3295:e=>{const t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:t,MAX_SAFE_COMPONENT_LENGTH:16}},4225:e=>{const t="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=t},6742:e=>{const t=/^[0-9]+$/,n=(e,n)=>{const r=t.test(e),i=t.test(n);return r&&i&&(e=+e,n=+n),e===n?0:r&&!i?-1:i&&!r?1:e<n?-1:1};e.exports={compareIdentifiers:n,rcompareIdentifiers:(e,t)=>n(t,e)}},2893:e=>{const t=["includePrerelease","loose","rtl"];e.exports=e=>e?"object"!=typeof e?{loose:!0}:t.filter((t=>e[t])).reduce(((e,t)=>(e[t]=!0,e)),{}):{}},5765:(e,t,n)=>{const{MAX_SAFE_COMPONENT_LENGTH:r}=n(3295),i=n(4225),o=(t=e.exports={}).re=[],s=t.src=[],a=t.t={};let l=0;const u=(e,t,n)=>{const r=l++;i(r,t),a[e]=r,s[r]=t,o[r]=new RegExp(t,n?"g":void 0)};u("NUMERICIDENTIFIER","0|[1-9]\\d*"),u("NUMERICIDENTIFIERLOOSE","[0-9]+"),u("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),u("MAINVERSION",`(${s[a.NUMERICIDENTIFIER]})\\.(${s[a.NUMERICIDENTIFIER]})\\.(${s[a.NUMERICIDENTIFIER]})`),u("MAINVERSIONLOOSE",`(${s[a.NUMERICIDENTIFIERLOOSE]})\\.(${s[a.NUMERICIDENTIFIERLOOSE]})\\.(${s[a.NUMERICIDENTIFIERLOOSE]})`),u("PRERELEASEIDENTIFIER",`(?:${s[a.NUMERICIDENTIFIER]}|${s[a.NONNUMERICIDENTIFIER]})`),u("PRERELEASEIDENTIFIERLOOSE",`(?:${s[a.NUMERICIDENTIFIERLOOSE]}|${s[a.NONNUMERICIDENTIFIER]})`),u("PRERELEASE",`(?:-(${s[a.PRERELEASEIDENTIFIER]}(?:\\.${s[a.PRERELEASEIDENTIFIER]})*))`),u("PRERELEASELOOSE",`(?:-?(${s[a.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${s[a.PRERELEASEIDENTIFIERLOOSE]})*))`),u("BUILDIDENTIFIER","[0-9A-Za-z-]+"),u("BUILD",`(?:\\+(${s[a.BUILDIDENTIFIER]}(?:\\.${s[a.BUILDIDENTIFIER]})*))`),u("FULLPLAIN",`v?${s[a.MAINVERSION]}${s[a.PRERELEASE]}?${s[a.BUILD]}?`),u("FULL",`^${s[a.FULLPLAIN]}$`),u("LOOSEPLAIN",`[v=\\s]*${s[a.MAINVERSIONLOOSE]}${s[a.PRERELEASELOOSE]}?${s[a.BUILD]}?`),u("LOOSE",`^${s[a.LOOSEPLAIN]}$`),u("GTLT","((?:<|>)?=?)"),u("XRANGEIDENTIFIERLOOSE",`${s[a.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),u("XRANGEIDENTIFIER",`${s[a.NUMERICIDENTIFIER]}|x|X|\\*`),u("XRANGEPLAIN",`[v=\\s]*(${s[a.XRANGEIDENTIFIER]})(?:\\.(${s[a.XRANGEIDENTIFIER]})(?:\\.(${s[a.XRANGEIDENTIFIER]})(?:${s[a.PRERELEASE]})?${s[a.BUILD]}?)?)?`),u("XRANGEPLAINLOOSE",`[v=\\s]*(${s[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[a.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[a.XRANGEIDENTIFIERLOOSE]})(?:${s[a.PRERELEASELOOSE]})?${s[a.BUILD]}?)?)?`),u("XRANGE",`^${s[a.GTLT]}\\s*${s[a.XRANGEPLAIN]}$`),u("XRANGELOOSE",`^${s[a.GTLT]}\\s*${s[a.XRANGEPLAINLOOSE]}$`),u("COERCE",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?(?:$|[^\\d])`),u("COERCERTL",s[a.COERCE],!0),u("LONETILDE","(?:~>?)"),u("TILDETRIM",`(\\s*)${s[a.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",u("TILDE",`^${s[a.LONETILDE]}${s[a.XRANGEPLAIN]}$`),u("TILDELOOSE",`^${s[a.LONETILDE]}${s[a.XRANGEPLAINLOOSE]}$`),u("LONECARET","(?:\\^)"),u("CARETTRIM",`(\\s*)${s[a.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",u("CARET",`^${s[a.LONECARET]}${s[a.XRANGEPLAIN]}$`),u("CARETLOOSE",`^${s[a.LONECARET]}${s[a.XRANGEPLAINLOOSE]}$`),u("COMPARATORLOOSE",`^${s[a.GTLT]}\\s*(${s[a.LOOSEPLAIN]})$|^$`),u("COMPARATOR",`^${s[a.GTLT]}\\s*(${s[a.FULLPLAIN]})$|^$`),u("COMPARATORTRIM",`(\\s*)${s[a.GTLT]}\\s*(${s[a.LOOSEPLAIN]}|${s[a.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",u("HYPHENRANGE",`^\\s*(${s[a.XRANGEPLAIN]})\\s+-\\s+(${s[a.XRANGEPLAIN]})\\s*$`),u("HYPHENRANGELOOSE",`^\\s*(${s[a.XRANGEPLAINLOOSE]})\\s+-\\s+(${s[a.XRANGEPLAINLOOSE]})\\s*$`),u("STAR","(<|>)?=?\\s*\\*"),u("GTE0","^\\s*>=\\s*0.0.0\\s*$"),u("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")},7606:(e,t,n)=>{const r=n(6826);e.exports=(e,t,n)=>r(e,t,">",n)},2937:(e,t,n)=>{const r=n(6902);e.exports=(e,t,n)=>(e=new r(e,n),t=new r(t,n),e.intersects(t))},32:(e,t,n)=>{const r=n(6826);e.exports=(e,t,n)=>r(e,t,"<",n)},5775:(e,t,n)=>{const r=n(6376),i=n(6902);e.exports=(e,t,n)=>{let o=null,s=null,a=null;try{a=new i(t,n)}catch(e){return null}return e.forEach((e=>{a.test(e)&&(o&&-1!==s.compare(e)||(o=e,s=new r(o,n)))})),o}},1657:(e,t,n)=>{const r=n(6376),i=n(6902);e.exports=(e,t,n)=>{let o=null,s=null,a=null;try{a=new i(t,n)}catch(e){return null}return e.forEach((e=>{a.test(e)&&(o&&1!==s.compare(e)||(o=e,s=new r(o,n)))})),o}},5316:(e,t,n)=>{const r=n(6376),i=n(6902),o=n(1312);e.exports=(e,t)=>{e=new i(e,t);let n=new r("0.0.0");if(e.test(n))return n;if(n=new r("0.0.0-0"),e.test(n))return n;n=null;for(let t=0;t<e.set.length;++t){const i=e.set[t];let s=null;i.forEach((e=>{const t=new r(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":s&&!o(t,s)||(s=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}})),!s||n&&!o(n,s)||(n=s)}return n&&e.test(n)?n:null}},6826:(e,t,n)=>{const r=n(6376),i=n(2257),{ANY:o}=i,s=n(6902),a=n(5712),l=n(1312),u=n(1544),c=n(2056),d=n(5903);e.exports=(e,t,n,h)=>{let p,f,v,m,g;switch(e=new r(e,h),t=new s(t,h),n){case">":p=l,f=c,v=u,m=">",g=">=";break;case"<":p=u,f=d,v=l,m="<",g="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(a(e,t,h))return!1;for(let n=0;n<t.set.length;++n){const r=t.set[n];let s=null,a=null;if(r.forEach((e=>{e.semver===o&&(e=new i(">=0.0.0")),s=s||e,a=a||e,p(e.semver,s.semver,h)?s=e:v(e.semver,a.semver,h)&&(a=e)})),s.operator===m||s.operator===g)return!1;if((!a.operator||a.operator===m)&&f(e,a.semver))return!1;if(a.operator===g&&v(e,a.semver))return!1}return!0}},7908:(e,t,n)=>{const r=n(5712),i=n(6269);e.exports=(e,t,n)=>{const o=[];let s=null,a=null;const l=e.sort(((e,t)=>i(e,t,n)));for(const e of l)r(e,t,n)?(a=e,s||(s=e)):(a&&o.push([s,a]),a=null,s=null);s&&o.push([s,null]);const u=[];for(const[e,t]of o)e===t?u.push(e):t||e!==l[0]?t?e===l[0]?u.push(`<=${t}`):u.push(`${e} - ${t}`):u.push(`>=${e}`):u.push("*");const c=u.join(" || "),d="string"==typeof t.raw?t.raw:String(t);return c.length<d.length?c:t}},799:(e,t,n)=>{const r=n(6902),i=n(2257),{ANY:o}=i,s=n(5712),a=n(6269),l=(e,t,n)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===o){if(1===t.length&&t[0].semver===o)return!0;e=n.includePrerelease?[new i(">=0.0.0-0")]:[new i(">=0.0.0")]}if(1===t.length&&t[0].semver===o){if(n.includePrerelease)return!0;t=[new i(">=0.0.0")]}const r=new Set;let l,d,h,p,f,v,m;for(const t of e)">"===t.operator||">="===t.operator?l=u(l,t,n):"<"===t.operator||"<="===t.operator?d=c(d,t,n):r.add(t.semver);if(r.size>1)return null;if(l&&d){if(h=a(l.semver,d.semver,n),h>0)return null;if(0===h&&(">="!==l.operator||"<="!==d.operator))return null}for(const e of r){if(l&&!s(e,String(l),n))return null;if(d&&!s(e,String(d),n))return null;for(const r of t)if(!s(e,String(r),n))return!1;return!0}let g=!(!d||n.includePrerelease||!d.semver.prerelease.length)&&d.semver,y=!(!l||n.includePrerelease||!l.semver.prerelease.length)&&l.semver;g&&1===g.prerelease.length&&"<"===d.operator&&0===g.prerelease[0]&&(g=!1);for(const e of t){if(m=m||">"===e.operator||">="===e.operator,v=v||"<"===e.operator||"<="===e.operator,l)if(y&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===y.major&&e.semver.minor===y.minor&&e.semver.patch===y.patch&&(y=!1),">"===e.operator||">="===e.operator){if(p=u(l,e,n),p===e&&p!==l)return!1}else if(">="===l.operator&&!s(l.semver,String(e),n))return!1;if(d)if(g&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===g.major&&e.semver.minor===g.minor&&e.semver.patch===g.patch&&(g=!1),"<"===e.operator||"<="===e.operator){if(f=c(d,e,n),f===e&&f!==d)return!1}else if("<="===d.operator&&!s(d.semver,String(e),n))return!1;if(!e.operator&&(d||l)&&0!==h)return!1}return!(l&&v&&!d&&0!==h||d&&m&&!l&&0!==h||y||g)},u=(e,t,n)=>{if(!e)return t;const r=a(e.semver,t.semver,n);return r>0?e:r<0||">"===t.operator&&">="===e.operator?t:e},c=(e,t,n)=>{if(!e)return t;const r=a(e.semver,t.semver,n);return r<0?e:r>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,n={})=>{if(e===t)return!0;e=new r(e,n),t=new r(t,n);let i=!1;e:for(const r of e.set){for(const e of t.set){const t=l(r,e,n);if(i=i||null!==t,t)continue e}if(i)return!1}return!0}},1042:(e,t,n)=>{const r=n(6902);e.exports=(e,t)=>new r(e,t).set.map((e=>e.map((e=>e.value)).join(" ").trim().split(" ")))},9042:(e,t,n)=>{const r=n(6902);e.exports=(e,t)=>{try{return new r(e,t).range||"*"}catch(e){return null}}},9602:e=>{"use strict";e.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}},4411:(e,t,n)=>{"use strict";function r(e){var t=this;if(t instanceof r||(t=new r),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var n=0,i=arguments.length;n<i;n++)t.push(arguments[n]);return t}function i(e,t){e.tail=new s(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function o(e,t){e.head=new s(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function s(e,t,n,r){if(!(this instanceof s))return new s(e,t,n,r);this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}e.exports=r,r.Node=s,r.create=r,r.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},r.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},r.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},r.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)i(this,arguments[e]);return this.length},r.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)o(this,arguments[e]);return this.length},r.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},r.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},r.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;null!==n;r++)e.call(t,n.value,r,this),n=n.next},r.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;null!==n;r--)e.call(t,n.value,r,this),n=n.prev},r.prototype.get=function(e){for(var t=0,n=this.head;null!==n&&t<e;t++)n=n.next;if(t===e&&null!==n)return n.value},r.prototype.getReverse=function(e){for(var t=0,n=this.tail;null!==n&&t<e;t++)n=n.prev;if(t===e&&null!==n)return n.value},r.prototype.map=function(e,t){t=t||this;for(var n=new r,i=this.head;null!==i;)n.push(e.call(t,i.value,this)),i=i.next;return n},r.prototype.mapReverse=function(e,t){t=t||this;for(var n=new r,i=this.tail;null!==i;)n.push(e.call(t,i.value,this)),i=i.prev;return n},r.prototype.reduce=function(e,t){var n,r=this.head;if(arguments.length>1)n=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,n=this.head.value}for(var i=0;null!==r;i++)n=e(n,r.value,i),r=r.next;return n},r.prototype.reduceReverse=function(e,t){var n,r=this.tail;if(arguments.length>1)n=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,n=this.tail.value}for(var i=this.length-1;null!==r;i--)n=e(n,r.value,i),r=r.prev;return n},r.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;null!==n;t++)e[t]=n.value,n=n.next;return e},r.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;null!==n;t++)e[t]=n.value,n=n.prev;return e},r.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new r;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=0,o=this.head;null!==o&&i<e;i++)o=o.next;for(;null!==o&&i<t;i++,o=o.next)n.push(o.value);return n},r.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new r;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=this.length,o=this.tail;null!==o&&i>t;i--)o=o.prev;for(;null!==o&&i>e;i--,o=o.prev)n.push(o.value);return n},r.prototype.splice=function(e,t,...n){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var r=0,i=this.head;null!==i&&r<e;r++)i=i.next;var o,a,l,u,c=[];for(r=0;i&&r<t;r++)c.push(i.value),i=this.removeNode(i);for(null===i&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev),r=0;r<n.length;r++)o=this,a=i,l=n[r],u=void 0,null===(u=a===o.head?new s(l,null,a,o):new s(l,a,a.next,o)).next&&(o.tail=u),null===u.prev&&(o.head=u),o.length++,i=u;return c},r.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;null!==n;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=t,this.tail=e,this};try{n(9602)(r)}catch(e){}},8891:e=>{"use strict";e.exports=n},6262:e=>{"use strict";e.exports=r}},t={};function i(n){var r=t[n];if(void 0!==r)return r.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,i),o.exports}i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};return(()=>{"use strict";i.r(o),i.d(o,{AppType:()=>s,PublishStatus:()=>a,SearchType:()=>r,appServices:()=>t,getResourceOrigin:()=>ie,userServices:()=>n});var e={};i.r(e),i.d(e,{addItemResource:()=>M,createItem:()=>I,getItem:()=>R,getItemData:()=>P,getItemResources:()=>O,getOriginUrl:()=>m,getRequestMethod:()=>E,getUserContentUrl:()=>g,getUserName:()=>y,importItem:()=>$,removeItem:()=>x,removeItemResource:()=>j,request:()=>f,searchItems:()=>d,updateItem:()=>L,updateItemResource:()=>U});var t={};i.r(t),i.d(t,{addAppResource:()=>Je,addToFavorites:()=>_e,changeAppFolder:()=>qe,createAppByDefaultTemplate:()=>Re,createAppByItemTemplate:()=>Ae,createAppByTemplateId:()=>Pe,createTemplateByApp:()=>Oe,deleteApp:()=>ke,duplicateApp:()=>xe,getAppConfig:()=>Ne,getAppGroups:()=>Be,getAppInfo:()=>Ue,getAppResources:()=>We,getDefaultTemplateConfig:()=>Ke,getFolders:()=>Fe,getUserTags:()=>Ve,importAppFromPortal:()=>be,importItem:()=>Te,publishApp:()=>Ge,removeAppResource:()=>Ye,removeFromFavorites:()=>Xe,saveApp:()=>De,saveAsApp:()=>je,searchApp:()=>Le,searchGroups:()=>He,updateAppInfo:()=>Me,updateAppResource:()=>ze,updateAppThumbnail:()=>Ce});var n={};i.r(n),i.d(n,{addUserResource:()=>it,getUserResource:()=>ot,getUserResources:()=>st,initUserResource:()=>ut,removeUserResource:()=>at,updateUserResource:()=>lt});var r,s,a,l=i(1249),u=i(8891);!function(e){e.AGOL="AGOL",e.Portal="Portal",e.Other="Other"}(r||(r={})),function(e){e.TemplateType="Web Experience Template",e.ExperienceType="Web Experience"}(s||(s={})),function(e){e.Published="Published",e.Draft="Draft",e.Changed="Changed"}(a||(a={}));var c=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};function d(e,t=r.Other){return c(this,void 0,void 0,(function*(){return yield h(e,"item",t)}))}function h(e,t,n=r.Other){return c(this,void 0,void 0,(function*(){let i,o;return i=`${n===r.AGOL?"https://www.arcgis.com":window.location.origin}/sharing/rest/search`,o="string"==typeof e||e instanceof u.esri.restPortal.SearchQueryBuilder?{params:{q:e}}:u.esri.restRequest.appendCustomParams(Object.assign(Object.assign({},e),{f:"json"}),["q","num","start","sortField","sortOrder","portalUrl","f"]),yield f(i,o,"GET").then((n=>(n.nextStart&&-1!==n.nextStart&&(n.nextPage=function(){return c(this,void 0,void 0,(function*(){let r;return"string"==typeof e||e instanceof u.esri.restPortal.SearchQueryBuilder?r={q:e,start:n.nextStart}:(r=e,r.start=n.nextStart),yield h(r,t)}))}),n)))}))}var p=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};function f(e,t={params:{f:"json"}},n="POST"){return p(this,void 0,void 0,(function*(){if("GET"===n){const n=e+function(e){if(!e)return"";const t=Object.keys(e);return t.length?"?"+t.map((t=>encodeURIComponent(t)+"="+encodeURIComponent(e[t]))).join("&"):""}(t.params);return yield fetch(n,{method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>p(this,void 0,void 0,(function*(){return yield e.json()})))).then((e=>p(this,void 0,void 0,(function*(){return yield Promise.resolve(e)}))))}return"POST"===n?t.params&&"FormData"===t.params.constructor.name?yield fetch(e,{method:"POST",body:t.params}).then((e=>p(this,void 0,void 0,(function*(){return yield e.json()})))).then((e=>p(this,void 0,void 0,(function*(){return yield Promise.resolve(e)})))):yield fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t.params)}).then((e=>p(this,void 0,void 0,(function*(){return yield e.json()})))).then((e=>p(this,void 0,void 0,(function*(){return yield Promise.resolve(e)})))):yield Promise.reject(null)}))}const v=u.esri.restRequest.request;function m(e=!1){return e?u.urlUtils.getArcgisOnlineUrl():window.location.origin}function g(e=!1){return e?"/sharing/rest/content/":"/sharing/rest/content/users/"}function y(){var e;return null===(e=(0,u.getAppStore)().getState().user)||void 0===e?void 0:e.username}function E(e=!1){return e?v:f}function S(e){const t=JSON.parse(JSON.stringify(e));return t.data&&("undefined"!=typeof Blob&&e.data instanceof Blob||"ReadStream"===e.data.constructor.name?t.file=e.data:t.text=e.data,delete t.data),t}var w=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};function I(e){return w(this,void 0,void 0,(function*(){const t=Object.assign({folderId:null},e);return yield function(e){var t,n;return w(this,void 0,void 0,(function*(){if(e.file&&!e.multipart)return yield Promise.reject(new Error("The request must be a multipart request for file uploading."));if(e.multipart&&!e.filename)return yield Promise.reject(new Error("The file name is required for a multipart request."));const r=y(),i=`${m()}${g()}addItem`;e.params=Object.assign(Object.assign(Object.assign({},e.params),S(e.item)),{portalUrl:null===(n=null===(t=(0,u.getAppStore)())||void 0===t?void 0:t.getState())||void 0===n?void 0:n.portalUrl});const o=u.esri.restRequest.appendCustomParams(e,["owner","folderId","file","dataUrl","text","async","multipart","filename","overwrite"],{params:Object.assign({},e.params)});return o.params.username=r,yield f(i,o)}))}(t)}))}function $(e,t){return w(this,void 0,void 0,(function*(){const n=`${m()}${g()}importItem`;if(!(null==e?void 0:e.appZip))return Promise.reject("No app files");t.params=Object.assign(Object.assign({},t.params),e);const r=Object.keys(t.params),i=new FormData;for(let e=0;e<r.length;e++)i.append(r[e],t.params[r[e]]);return t.params=i,yield f(n,t)}))}var A=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};function P(e,t,n=!1){return A(this,void 0,void 0,(function*(){const r=`${m(n)}${g(n)}items/${e}/data`,i=Object.assign({params:{}},t);i.file&&(i.params.f=null),n&&!T()&&delete i.authentication;const o=E(n);return yield o(r,i).catch((e=>{if(!/Unexpected end of (JSON input|data at line 1 column 1)/i.test(e.message))throw e}))}))}function R(e,t,n=!1){return A(this,void 0,void 0,(function*(){const r=`${m(n)}${g(n)}items/${e}`,i=Object.assign({},t);n&&!T()&&delete i.authentication;const o=E(n);return yield o(r,i)}))}function O(e,t,n=!1){return A(this,void 0,void 0,(function*(){const r=`${m(n)}${g(n)}items/${e}/resources`;t.params=Object.assign(Object.assign({},t.params),{num:1e3}),n&&!T()&&delete t.authentication;const i=E(n);return yield i(r,t)}))}function T(){const e=(0,u.getAppStore)().getState().portalUrl;return u.portalUrlUtils.isAGOLDomain(e)}var b=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};function x(e){return b(this,void 0,void 0,(function*(){const t=y(),n=m();e.userName=t;const r=`${n}${g()}items/${e.id}/delete`;return yield f(r,e)}))}function j(e){return b(this,void 0,void 0,(function*(){const t=`${m()}${g()}items/${e.id}/removeResources`;return e.params=Object.assign(Object.assign({},e.params),{resource:e.resource}),yield f(t,e)}))}var N=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};function L(e){return N(this,void 0,void 0,(function*(){const t=y(),n=m();e.userName=t;const r=`${n}${g()}items/${e.item.id}/update`;if(e.params=Object.assign(Object.assign({},e.params),S(e.item)),e.item.thumbnail&&"string"!=typeof e.item.thumbnail){e.params=Object.assign(Object.assign({},e.params),e.item);const t=Object.keys(e.params),n=new FormData;for(let r=0;r<t.length;r++)n.append(t[r],e.params[t[r]]);e.params=n}return yield f(r,e)}))}function U(e){return N(this,void 0,void 0,(function*(){const t=`${m()}${g()}items/${e.id}/updateResources`;e.params=Object.assign(Object.assign({fileName:e.name,text:e.content},e.params),{file:e.resource}),delete e.params.file,e.params.file=e.resource,void 0!==e.private&&(e.params.access=e.private?"private":"inherit");const n=Object.keys(e.params),r=new FormData;for(let t=0;t<n.length;t++)r.append(n[t],e.params[n[t]]);return e.params=r,yield f(t,e)}))}function M(e){return t=this,n=void 0,i=function*(){const t=`${m()}${g()}items/${e.id}/addResources`;e.params=Object.assign(Object.assign({fileName:e.name,text:e.content,access:e.private?"private":"inherit"},e.params),{file:e.resource}),delete e.params.file,e.params.file=e.resource;const n=Object.keys(e.params),r=new FormData;for(let t=0;t<n.length;t++)r.append(n[t],e.params[n[t]]);return e.params=r,yield f(t,e)},new((r=void 0)||(r=Promise))((function(e,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(s,a)}l((i=i.apply(t,n||[])).next())}));var t,n,r,i}var C=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const k=u.SessionManager.getInstance().isTrustedServer((0,u.getAppStore)().getState().portalUrl);function D(e,t={f:"json"},n="POST"){return C(this,void 0,void 0,(function*(){if("GET"===n){const n=e+function(e){if(!e)return"";const t=Object.keys(e);return t.length?"?"+t.map((t=>encodeURIComponent(t)+"="+encodeURIComponent(e[t]))).join("&"):""}(t);return yield fetch(n,{credentials:k?"include":"same-origin",method:"GET",headers:{"Content-Type":"application/json"}}).then((e=>C(this,void 0,void 0,(function*(){return yield e.json()})))).then((e=>C(this,void 0,void 0,(function*(){return yield Promise.resolve(e)}))))}return"POST"===n?t&&"FormData"===t.constructor.name?yield fetch(e,{credentials:k?"include":"same-origin",method:"POST",body:t}).then((e=>C(this,void 0,void 0,(function*(){return yield e.json()})))).then((e=>C(this,void 0,void 0,(function*(){return yield Promise.resolve(e)})))):yield fetch(e,{credentials:k?"include":"same-origin",method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((e=>C(this,void 0,void 0,(function*(){return yield e.json()})))).then((e=>C(this,void 0,void 0,(function*(){return yield Promise.resolve(e)})))):yield Promise.reject(null)}))}const G={frameworkAction_TriggerLayer:"Trigger data",frameworkAction_SetData:"Select data",frameworkAction_ActionLayer:"Action data",frameworkAction_Conditions:"Conditions",frameworkAction_RelateMessage:"Trigger / action connection",frameworkAction_TriggerLayerField:"Select a trigger field",frameworkAction_None:"none",frameworkAction_Equals:"equals",frameworkAction_ActionLayerField:"Select an action field",frameworkAction_MoreConditions:"More conditions",frameworkAction_SetExpression:"Please set your expression first.",frameworkAction_ChooseLayer:"Select data",frameworkAction_AutoBind:"Auto bound.",frameworkAction_NoLayer:"No data.",frameworkAction_QueryByExtent:"Query by current extent",defaultTextPlaceholder:"Double click to edit text",titlePlaceholder:"Here is the title",subTitlePlaceholder:"Here is the subtitle",shortTitlePlaceholder:"Title",shortSubTitlePlaceholder:"Subtitle",copyrightPlaceholder:"Copyright info",cardTitle:"Card title",bookmark:"Bookmark",number:"Number",appItemCopy:"Copy"};var F=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const _=u.esri.restRequest.request;function X(e){var t,n;if(!(null==e?void 0:e.portalUrl))return!window.jimuConfig.isDevEdition;const r=(null==e?void 0:e.portalUrl)||"",i=(null===(n=null===(t=(0,u.getAppStore)())||void 0===t?void 0:t.getState())||void 0===n?void 0:n.portalUrl)||"",o=(null==i?void 0:i.includes(r))||(null==r?void 0:r.includes(i));return(u.portalUrlUtils.isAGOLDomain(r)&&u.portalUrlUtils.isAGOLDomain(i)||o)&&!q(e)}function B(e){if(!(null==e?void 0:e.portalUrl))return!1;const t=(null==e?void 0:e.portalUrl)||"",n=u.portalUrlUtils.isAGOLDomain(t),r=!X(e),i=!q(e);return r&&i&&n}function q(e){return!!((null==e?void 0:e.portalUrl)||"").endsWith("localhost:")||e.isLocalApp}function V(e){if(q(e))return{};const t=u.SessionManager.getInstance().getMainSession();return X(e)?t:{}}function H(e,t=!1,n=""){return F(this,void 0,void 0,(function*(){const i=u.SessionManager.getInstance().getMainSession();let o=null;const a=(null==n?void 0:n.includes("Template"))?s.TemplateType:s.ExperienceType;return yield Le({q:`type: "${a}" AND owner:${null==i?void 0:i.username} AND  title:"${e}"`,sortField:"modified",sortOrder:"desc"},r.Other).then((n=>F(this,void 0,void 0,(function*(){const r=n.results;if(r&&r.length>0){const n=function(e,t){const n=[],r=/^[\d]+$/;return e.forEach((e=>{var i,o;const s=null===(o=null===(i=e.title)||void 0===i?void 0:i.split(`${t} `)[1])||void 0===o?void 0:o.split(" ")[0];r.test(s)&&n.push(Number(s))})),n.sort((function(e,t){return e<t?1:-1})),n[0]||1}(r,e);return o=ne(e,r,n,t),yield Promise.resolve(o)}return o=t?e:`${e} 1`,yield Promise.resolve(o)})))).catch((e=>F(this,void 0,void 0,(function*(){return console.error(e),yield Promise.reject(e)}))))}))}function K(e,t,n=!1){return F(this,void 0,void 0,(function*(){return yield function(e){return F(this,void 0,void 0,(function*(){const t=u.SessionManager.getInstance().getMainSession();return yield pe({item:{id:e,owner:null==t?void 0:t.username,text:"",data:{__not_publish:!0}},authentication:u.SessionManager.getInstance().getMainSession()}).then((()=>F(this,void 0,void 0,(function*(){return yield Promise.resolve(!0)}))),(e=>F(this,void 0,void 0,(function*(){return console.error(e),yield Promise.reject(e)}))))}))}(e).then((r=>F(this,void 0,void 0,(function*(){return r?n?yield function(e,t){return F(this,void 0,void 0,(function*(){return yield function(e,t){return F(this,void 0,void 0,(function*(){return yield Ne(t).then((n=>F(this,void 0,void 0,(function*(){const r=z(n,t);r.template=null==t?void 0:t.id,delete r.appProxies,delete r.historyLabels;const i=V({portalUrl:window.jimuConfig.isDevEdition?"localhost:":(0,u.getAppStore)().getState().portalUrl});if(null==n?void 0:n.__not_publish)return yield Promise.reject("This item is not published");const o=new Blob([JSON.stringify(r)],{type:"application/json"});return yield ge({id:e,resource:o,name:"config.json",params:{resourcesPrefix:"config"},authentication:i}).then((()=>F(this,void 0,void 0,(function*(){return yield Promise.resolve(!0)}))),(e=>F(this,void 0,void 0,(function*(){return console.error(e),yield Promise.reject(e)}))))}))),(e=>F(this,void 0,void 0,(function*(){return yield Promise.reject("Resource does not exist or is inaccessible")}))))}))}(e,t).then((n=>F(this,void 0,void 0,(function*(){return yield Y(e,t,!0).then((e=>F(this,void 0,void 0,(function*(){return e?yield Promise.resolve(!0):yield Promise.reject("Resource does not exist or is inaccessible")}))),(e=>F(this,void 0,void 0,(function*(){return yield Promise.reject(e)}))))}))))}))}(e,t):yield function(e,t){return F(this,void 0,void 0,(function*(){return yield Y(e,t).then((e=>F(this,void 0,void 0,(function*(){return e?yield Promise.resolve(!0):yield Promise.reject("Resource does not exist or is inaccessible")}))),(e=>F(this,void 0,void 0,(function*(){return yield Promise.reject(e)}))))}))}(e,t):yield Promise.reject(null)}))),(e=>F(this,void 0,void 0,(function*(){return yield Promise.reject(e)}))))}))}function Y(e,t,n=!1){return F(this,void 0,void 0,(function*(){const r=V(t);return yield me(t,{authentication:r}).then((r=>F(this,void 0,void 0,(function*(){const i=[],o=r&&r.resources;let s=!1;if(o)for(let r=0;r<o.length;r++){const a="config/config.json"===o[r].resource;n&&a||(a&&(s=!0),i.push(W(e,t,o[r])))}return s||n?yield Promise.all(i):yield Promise.resolve(null)}))),(e=>F(this,void 0,void 0,(function*(){return yield Promise.resolve(null)}))))}))}function J(e,t,n){return F(this,void 0,void 0,(function*(){const r=V({portalUrl:window.jimuConfig.isDevEdition?"localhost:":(0,u.getAppStore)().getState().portalUrl}),i=V(t);if(n){const o=`${ie(t)}${t.id}/info/${n}?token=${null==i?void 0:i.token}`,s=`${ie(t)}${t.id}/${n}`,a=X(t)?o:s;return yield new Promise((function(t,n){const i=new XMLHttpRequest;i.open("GET",a,!0),i.responseType="blob",i.onload=function(i){if(200===this.status){const i=this.response;return Ce({id:e,thumbnail:i,f:"json",token:null==r?void 0:r.token}).then((()=>t(!0)),(()=>n(!1)))}return n(!1)},i.onerror=function(e){return n()},i.send()}))}return Promise.resolve(!0)}))}function W(e,t,n){return F(this,void 0,void 0,(function*(){const r=V(t),i=X(t)?`?token=${null==r?void 0:r.token}`:"",o=`${ie(t)}${t.id}/resources/`,s=V({portalUrl:window.jimuConfig.isDevEdition?"localhost:":(0,u.getAppStore)().getState().portalUrl});if("config/config.json"===n.resource||"images/image-resources-list.json"===n.resource){const r=o+n.resource+i;return yield fetch(r,{cache:"no-cache"}).then((e=>F(this,void 0,void 0,(function*(){return yield e.json()})))).then((r=>F(this,void 0,void 0,(function*(){const i="config/config.json"===n.resource?z(r,t):r;return yield function(e,t,n){return F(this,void 0,void 0,(function*(){const r=ie(t)+t+"/resources/",i=new RegExp("^"+r);const o={matcher:function(e){return i.test(e)},handler:function(n){return n.replace("/"+t+"/","/"+e+"/")}};return Promise.resolve(u.utils.replaceStringInObject(n,o))}))}(e,t.id,i).then((t=>F(this,void 0,void 0,(function*(){delete t.appProxies,delete t.historyLabels;const r=new Blob([JSON.stringify(t)],{type:"application/json"});return yield ge({id:e,resource:r,name:n.resource.split("/")[n.resource.split("/").length-1],params:{resourcesPrefix:n.resource.split("/").slice(0,n.resource.split("/").length-1).join("/")},authentication:s}).then((()=>F(this,void 0,void 0,(function*(){return yield Promise.resolve(!0)}))),(e=>F(this,void 0,void 0,(function*(){return console.error(e),yield Promise.reject(e)}))))}))))})))).catch((e=>F(this,void 0,void 0,(function*(){return console.error(e),yield Promise.reject(e)}))))}{const t=o+n.resource+i;return yield new Promise((function(r,i){const o=new XMLHttpRequest;o.open("GET",t,!0),o.responseType="blob",o.onload=function(t){if(200===this.status){const t=this.response;return ge({id:e,resource:t,name:n.resource.split("/")[n.resource.split("/").length-1],params:{resourcesPrefix:n.resource.split("/").slice(0,n.resource.split("/").length-1).join("/")},authentication:s}).then((()=>r(!0)),(()=>r(!1)))}return r(!1)},o.onerror=function(e){return r(!1)},o.send()}))}}))}function z(e,t){var n;const r=(0,u.getAppStore)().getState().portalUrl;e.attributes&&(e.attributes.portalUrl=r);const i=null==e?void 0:e.dataSources;if(i&&B(t))for(const e in i)Q(null===(n=i[e])||void 0===n?void 0:n.portalUrl)&&(i[e].portalUrl=r);return e}function Q(e){let t=!1;const n=(0,u.getAppStore)().getState().portalUrl;return(Z(n,e,"mapsdevext.arcgis.com")||Z(n,e,"mapsqa.arcgis.com")||Z(n,e,"maps.arcgis.com"))&&(t=!0),t}function Z(e,t,n){return((null==e?void 0:e.endsWith(n))||(null==e?void 0:e.endsWith(`${n}/`)))&&((null==t?void 0:t.endsWith(n))||(null==t?void 0:t.endsWith(`${n}/`)))}function ee(e,t,n){return F(this,void 0,void 0,(function*(){return yield Ue(e).then((r=>F(this,void 0,void 0,(function*(){if(r){const i=t?s.TemplateType:s.ExperienceType;return yield H(r.title).then((o=>F(this,void 0,void 0,(function*(){if(o){const s={name:o,tags:r.tags,thumbnail:r.thumbnail,type:i};return yield re(s,n).then((n=>F(this,void 0,void 0,(function*(){return n?yield K(n.id,e,!t).then((()=>F(this,void 0,void 0,(function*(){return yield Promise.resolve(n.id)}))),(e=>F(this,void 0,void 0,(function*(){return console.error(e),ke(n.id),yield Promise.reject(e)})))):yield Promise.reject(null)}))))}return yield Promise.reject(null)}))))}return yield Promise.reject(null)}))))}))}function te(e){const t=`version:${u.version}`;if(!e||0===e.length)return["EXB Experience","Ready To Use","JavaScript","status: Draft",t];let n=!1,r=!1;const i=e.map((e=>(e.includes("version:")&&(r=!0),e.includes("status:")?(n=!0,"status: Draft"):e)));return!n&&i.push("status: Draft"),!r&&i.push(t),i}function ne(e,t,n=1,r=!1){const i=1===n&&r?e:`${e} ${n}`;return function(e,t){let n=!1;return t.forEach((t=>{e===t.title&&(n=!0)})),n}(i,t)?ne(e,t,n+1):i}function re(e,t){return F(this,void 0,void 0,(function*(){const n={title:e.name,type:e.type||"Web Experience",typeKeywords:te(null==e?void 0:e.typeKeywords),snippet:(null==e?void 0:e.snippet)||"",description:(null==e?void 0:e.description)||"",tags:e.tags,thumbnail:e.thumbnail};return yield oe(n,t)}))}function ie(e){const t=B(e)?u.urlUtils.getArcgisOnlineUrl():(0,u.getAppStore)().getState().portalUrl;return(null==e?void 0:e.isLocalApp)?m()+"/apps/":u.portalUrlUtils.getHostUrlByOrgUrl(t)+"/sharing/rest/content/items/"}function oe(e,t){return F(this,void 0,void 0,(function*(){return t?yield(n={item:e,folderId:t,authentication:u.SessionManager.getInstance().getMainSession()},u.esri.restPortal.createItemInFolder(n)):yield function(e){return ce(this,void 0,void 0,(function*(){return he("createItem")(e)}))}({item:e,authentication:u.SessionManager.getInstance().getMainSession()});var n}))}function se(e,t){const n=e.historyLabels;Object.keys(n[t]||{}).forEach((r=>{var i;(null===(i=e[t])||void 0===i?void 0:i[r])||delete n[t][r]}))}function ae(e,t,n){const r=e[n],i=t[n];r&&i&&Object.keys(r).forEach((o=>{var s,a;const l=(null===(a=null===(s=t.historyLabels)||void 0===s?void 0:s[n])||void 0===a?void 0:a[o])||[];i[o]&&r[o].label!==i[o].label&&(l.includes(i[o].label)||l.push(i[o].label)),l.length>0&&(e.historyLabels?e.historyLabels[n]?e.historyLabels[n][o]=l:e.historyLabels[n]={[o]:l}:e.historyLabels={[n]:{[o]:l}})}))}const le=/<[^>]*>/gm,ue=e=>{if(!e)return!0;if("<p></p>"===e||"<p><br></p>"===e)return!0;let t="";return t=e.includes("<")?e.replace(le,""):e,t=null==t?void 0:t.trim(),!t};var ce=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const{importItem:de}=e;function he(t,n,r){const i=r?e[r]:e[t],o=u.esri.restPortal[t];return n?X(n)?o:i:window.jimuConfig.isDevEdition?i:o}function pe(e){return ce(this,void 0,void 0,(function*(){return he("updateItem")(e)}))}function fe(e){return ce(this,void 0,void 0,(function*(){return window.jimuConfig.isDevEdition?yield L(e):yield function(e){return t=this,n=void 0,i=function*(){const t=u.SessionManager.getInstance().getMainSession(),n=e.owner?e.owner:null==t?void 0:t.username,r=`${(0,u.getAppStore)().getState().portalUrl}/sharing/rest/content/users/${n}/items/${e.item.id}/update`;e.params=Object.assign(Object.assign({},e.params),e.item);const i=Object.keys(e.params),o=new FormData;for(let t=0;t<i.length;t++)o.append(i[t],e.params[i[t]]);return e.params=o,yield D(r,o)},new((r=void 0)||(r=Promise))((function(e,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(s,a)}l((i=i.apply(t,n||[])).next())}));var t,n,r,i}(e)}))}function ve(e,t){return ce(this,void 0,void 0,(function*(){return he("getItem",e)(e.id,t,B(e))}))}function me(e,t){return ce(this,void 0,void 0,(function*(){return he("getItemResources",e)(e.id,t,B(e))}))}function ge(e){return ce(this,void 0,void 0,(function*(){return he("addItemResource")(e)}))}function ye(e){return ce(this,void 0,void 0,(function*(){return yield function(e){return t=this,n=void 0,i=function*(){const t=u.SessionManager.getInstance().getMainSession(),n=`${(0,u.getAppStore)().getState().portalUrl}/sharing/rest/content/items/${e.items}/share`;e=Object.assign(Object.assign({},e),{f:"json",token:null==t?void 0:t.token});const r=Object.keys(e),i=new FormData;for(let t=0;t<r.length;t++)i.append(r[t],e[r[t]]);return e=i,yield D(n,e)},new((r=void 0)||(r=Promise))((function(e,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(s,a)}l((i=i.apply(t,n||[])).next())}));var t,n,r,i}(e)}))}function Ee(e){return ce(this,void 0,void 0,(function*(){return yield function(e){return t=this,n=void 0,i=function*(){const t=u.SessionManager.getInstance().getMainSession(),n=`${(0,u.getAppStore)().getState().portalUrl}/sharing/rest/content/items/${e.items}/unshare`;e=Object.assign(Object.assign({},e),{f:"json",token:null==t?void 0:t.token});const r=Object.keys(e),i=new FormData;for(let t=0;t<r.length;t++)i.append(r[t],e[r[t]]);return e=i,yield D(n,e)},new((r=void 0)||(r=Promise))((function(e,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(s,a)}l((i=i.apply(t,n||[])).next())}));var t,n,r,i}(e)}))}function Se(e){return ce(this,void 0,void 0,(function*(){return yield function(e){return t=this,n=void 0,i=function*(){const t=u.SessionManager.getInstance().getMainSession(),n=`${(0,u.getAppStore)().getState().portalUrl}/sharing/rest/content/itemsgroups`,r={params:e,httpMethod:"GET",authentication:t};return yield u.esri.restRequest.request(n,r)},new((r=void 0)||(r=Promise))((function(e,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(s,a)}l((i=i.apply(t,n||[])).next())}));var t,n,r,i}(e)}))}function we(e){return function(e){return t=this,n=void 0,i=function*(){const t=u.SessionManager.getInstance().getMainSession(),n=`${(0,u.getAppStore)().getState().portalUrl}/sharing/rest/content/users/${null==t?void 0:t.username}`,r=Object.assign(Object.assign({},e.params),{f:"json",token:null==t?void 0:t.token});return yield D(n,r,"GET")},new((r=void 0)||(r=Promise))((function(e,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(s,a)}l((i=i.apply(t,n||[])).next())}));var t,n,r,i}(e)}var Ie=i(6262),$e=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};function Ae(e,t){return $e(this,void 0,void 0,(function*(){return yield ee(e,!1,t)}))}function Pe(e){return $e(this,void 0,void 0,(function*(){return yield function(e){return F(this,void 0,void 0,(function*(){return yield function(e){return F(this,void 0,void 0,(function*(){const t=(0,u.getAppStore)().getState().portalUrl,n={id:e,portalUrl:t,isLocalApp:!1};return yield Ue(n).then((e=>F(this,void 0,void 0,(function*(){return yield Promise.resolve(n)})))).catch((e=>F(this,void 0,void 0,(function*(){return yield Promise.reject("Item does not exist or is inaccessible.")}))))}))}(e).then((e=>F(this,void 0,void 0,(function*(){return yield Promise.resolve(e)})))).catch((t=>F(this,void 0,void 0,(function*(){return yield function(e){return F(this,void 0,void 0,(function*(){const t=(0,u.getAppStore)().getState().portalUrl;if(u.portalUrlUtils.isAGOLDomain(t))return yield Promise.reject(!1);const n={id:e,portalUrl:"https://maps.arcgis.com",isLocalApp:!1};return yield Ue(n).then((e=>F(this,void 0,void 0,(function*(){return yield Promise.resolve(n)})))).catch((e=>F(this,void 0,void 0,(function*(){return yield Promise.reject("Item does not exist or is inaccessible.")}))))}))}(e).then((e=>F(this,void 0,void 0,(function*(){return yield Promise.resolve(e)})))).catch((t=>F(this,void 0,void 0,(function*(){return yield function(e){return F(this,void 0,void 0,(function*(){if(window.jimuConfig.isDevEdition){const t=(0,u.getAppStore)().getState().portalUrl,n={id:e,portalUrl:t,isLocalApp:!0};return yield Ue(n).then((e=>F(this,void 0,void 0,(function*(){return(null==e?void 0:e.success)?yield Promise.resolve(n):yield Promise.reject("Item does not exist or is inaccessible.")})))).catch((e=>F(this,void 0,void 0,(function*(){return yield Promise.reject("Item does not exist or is inaccessible.")}))))}return yield Promise.reject("Item does not exist or is inaccessible.")}))}(e)}))))}))))}))}(e).then((e=>$e(this,void 0,void 0,(function*(){return yield Ae(e)}))))}))}function Re(e,t,n,r,i){return $e(this,void 0,void 0,(function*(){return yield H(e).then((e=>$e(this,void 0,void 0,(function*(){if(e){const o={template:t,name:e,description:"",type:s.ExperienceType};return yield Promise.all([Ke(o)]).then((function(e){var t,s;return $e(this,void 0,void 0,(function*(){const a=e[0];a.template=o.template,a.attributes?a.attributes.portalUrl=(0,u.getAppStore)().getState().portalUrl:a.attributes={portalUrl:(0,u.getAppStore)().getState().portalUrl};const l=null===(s=null===(t=(0,u.getAppStore)().getState().portalSelf)||void 0===t?void 0:t.portalProperties)||void 0===s?void 0:s.sharedTheme;return a.sharedThemeVariables=u.sharedThemeUtils.createSharedThemeVariables(l),yield function(e,t){return F(this,void 0,void 0,(function*(){const n={title:e.name,type:e.type||"Web Experience",typeKeywords:["EXB Experience","Ready To Use","JavaScript","status: Draft",`version:${u.version}`],snippet:(null==e?void 0:e.snippet)||"",description:(null==e?void 0:e.description)||"",tags:e.tags,data:{__not_publish:!0}};return yield(()=>F(this,void 0,void 0,(function*(){return yield Promise.resolve(!1)})))().then((function(e){return F(this,void 0,void 0,(function*(){return e?yield Promise.reject("app existed."):yield oe(n,t)}))}))}))}(o,n).then((e=>$e(this,void 0,void 0,(function*(){return yield function(e,t,n,r){return F(this,void 0,void 0,(function*(){const i=u.moduleLoader.getModuleSync("jimu-for-builder").AppResourceManager.getInstance(),o=t.id;let s=u.utils.replaceI18nPlaceholdersInObject(e,u.i18n.getIntl(),G);return(a=s).attributes||(a.attributes={}),a.widgets||(a.widgets={}),a.widgetsManifest||(a.widgetsManifest={}),a.views||(a.views={}),a.sections||(a.sections={}),a.dialogs||(a.dialogs={}),a.pages||(a.pages={}),a.layouts||(a.layouts={}),a.dataSources||(a.dataSources={}),a.messageConfigs||(a.messageConfigs={}),s=a,u.appConfigUtils.addWebmapOrWebsceneToAppConfig(s,n,r),i.uploadAppConfigFileToPortal(o.toString(),s).then((()=>F(this,void 0,void 0,(function*(){return yield Promise.resolve(t)}))));var a}))}(a,e,r,i)}))))}))})).catch((e=>$e(this,void 0,void 0,(function*(){return console.error(e),yield Promise.reject(e)}))))}return yield Promise.reject(null)}))))}))}function Oe(e,t){return $e(this,void 0,void 0,(function*(){return yield ee(e,!0,t)}))}function Te(e){return $e(this,void 0,void 0,(function*(){const t=u.SessionManager.getInstance().getMainSession();return yield function(e,t){return ce(this,void 0,void 0,(function*(){return de(e,t)}))}(e,{authentication:t})}))}function be(e){return $e(this,void 0,void 0,(function*(){return function(e){return F(this,void 0,void 0,(function*(){const t=u.SessionManager.getInstance(),n=(new Date).getTime();return yield _(`${u.portalUrlUtils.getPortalRestUrl((0,u.getAppStore)().getState().portalUrl)}/content/items/${e}/resources/config/config.json`,{authentication:t.getSessionByUrl((0,u.getAppStore)().getState().portalUrl),httpMethod:"GET",params:{timestamp:n}}).catch((e=>F(this,void 0,void 0,(function*(){return yield Promise.reject(null)}))))}))}(null==e?void 0:e.id).then((t=>{const n=null==t?void 0:t.exbVersion;return l.gt(n,u.version)?Promise.reject({errMsg:`Failed to import the app ${e.title} . This app is created by a newer version ${n} of ArcGIS Experience Builder.`,errCode:"001",portalAppversion:n}):xe(e,null,!0)}),(e=>{Promise.reject({errMsg:"Invalid app",errCode:"001"})}))}))}function xe(e,t,n){return $e(this,void 0,void 0,(function*(){return yield Ue(e).then((r=>$e(this,void 0,void 0,(function*(){if(r){const i=u.i18n.getIntl().formatMessage({id:"copy"})||"copy",o=n?r.title:`${r.title} ${i}`;return yield H(o,!0,e.type).then((n=>$e(this,void 0,void 0,(function*(){if(n){const i={name:n,description:(null==r?void 0:r.description)||"",snippet:(null==r?void 0:r.snippet)||"",typeKeywords:(null==r?void 0:r.typeKeywords)||[],tags:r.tags,thumbnail:r.thumbnail,type:e.type||r.type};return yield re(i,t).then((t=>$e(this,void 0,void 0,(function*(){return t?yield J(t.id,e,r.thumbnail).then((()=>$e(this,void 0,void 0,(function*(){return yield K(t.id,e,!1).then((()=>$e(this,void 0,void 0,(function*(){return yield Promise.resolve(t.id)}))),(e=>$e(this,void 0,void 0,(function*(){return console.error(e),ke(t.id),yield Promise.reject(e)}))))})))):yield Promise.reject(null)}))))}return yield Promise.reject(null)}))))}return yield Promise.reject(null)}))))}))}function je(e,t,n,r){return $e(this,void 0,void 0,(function*(){return yield H(`${t.title}`,!0,t.type).then((i=>$e(this,void 0,void 0,(function*(){if(i){const i={name:t.title,description:(null==t?void 0:t.description)||"",snippet:(null==t?void 0:t.snippet)||"",typeKeywords:(null==t?void 0:t.typeKeywords)||[],tags:t.tags,thumbnail:t.thumbnail,type:e.type||e.type};return yield re(i,n).then((n=>$e(this,void 0,void 0,(function*(){return n?(t.id=n.id,yield function(e,t,n){return F(this,void 0,void 0,(function*(){if(n){const e=u.SessionManager.getInstance().getMainSession(),r={id:t.id,f:"json",token:null==e?void 0:e.token,thumbnail:n};return yield Ce(r,t.owner)}return yield J(t.id,e,e.thumbnail)}))}(e,t,r).then((()=>$e(this,void 0,void 0,(function*(){return yield K(n.id,e,!1).then((()=>$e(this,void 0,void 0,(function*(){return yield Promise.resolve(n.id)}))),(e=>$e(this,void 0,void 0,(function*(){return console.error(e),ke(n.id),yield Promise.reject(e)}))))}))))):yield Promise.reject(null)}))))}return yield Promise.reject(null)}))))}))}function Ne(e){return $e(this,void 0,void 0,(function*(){const t=V(e);return yield function(e,t){return ce(this,void 0,void 0,(function*(){return he("getItemData",e)(e.id,t,B(e))}))}(e,{authentication:t}).then((e=>$e(this,void 0,void 0,(function*(){return yield Promise.resolve(e)}))),(e=>$e(this,void 0,void 0,(function*(){return yield Promise.reject(e)}))))}))}function Le(e,t){return $e(this,void 0,void 0,(function*(){const n=function(e){let t;const n=(0,u.getAppStore)().getState().portalUrl,i=u.SessionManager.getInstance().getMainSession(),o=u.portalUrlUtils.isAGOLDomain(n);switch(e){case r.Portal:t=i;break;case r.AGOL:t=o?i:{};break;case r.Other:t=window.jimuConfig.isDevEdition?{}:i}return t}(t);return yield function(e,t){return ce(this,void 0,void 0,(function*(){return function(e){let t;const n=(0,u.getAppStore)().getState().portalUrl,i=u.portalUrlUtils.isAGOLDomain(n);switch(e){case r.Portal:t=u.esri.restPortal.searchItems;break;case r.AGOL:t=i?u.esri.restPortal.searchItems:d;break;case r.Other:t=window.jimuConfig.isDevEdition?d:u.esri.restPortal.searchItems}return t}(t)(e,t)}))}(Object.assign(Object.assign({},e),{authentication:n}),t).then((e=>$e(this,void 0,void 0,(function*(){return yield Promise.resolve(e)}))))}))}function Ue(e){return $e(this,void 0,void 0,(function*(){const t=V(e);return yield ve(e,{authentication:t}).then((e=>$e(this,void 0,void 0,(function*(){return yield Promise.resolve(e)}))))}))}function Me(e){return $e(this,void 0,void 0,(function*(){const t=u.SessionManager.getInstance().getMainSession(),n=window.jimuConfig.isDevEdition?"localhost:":(0,u.getAppStore)().getState().portalUrl,r={id:e.id,portalUrl:n};return yield ve(r,{authentication:t}).then((n=>$e(this,void 0,void 0,(function*(){return yield pe({item:e,owner:n.owner,authentication:t}).then((()=>null))}))))}))}function Ce(e,t=""){return $e(this,void 0,void 0,(function*(){const n=u.SessionManager.getInstance().getMainSession();return yield fe({item:e,authentication:n,owner:t}).then((()=>null))}))}function ke(e){return $e(this,void 0,void 0,(function*(){const t=u.SessionManager.getInstance().getMainSession();return yield ve({id:e},{authentication:t}).then((t=>$e(this,void 0,void 0,(function*(){return yield function(e){return ce(this,void 0,void 0,(function*(){return he("removeItem")(e)}))}({id:e,owner:t.owner,authentication:u.SessionManager.getInstance().getMainSession()})}))))}))}function De(e,t){return $e(this,void 0,void 0,(function*(){const n=u.SessionManager.getInstance().getMainSession(),r=u.moduleLoader.getModuleSync("jimu-for-builder").AppResourceManager,i=u.moduleLoader.getModuleSync("jimu-for-builder").appConfigUtils,o=(null==e?void 0:e.owner)||n.username,s=Object.assign({},i.getCleanAppConfig(t)),a=r.getInstance();return a.setAppConfigLocalFileToResource(s).then((t=>t?a.uploadAppConfigFileToPortal(e.id,t,o).then((()=>{if(a.getResourcesInDraft().imageResources){const e={};Object.keys(a.getResourcesInDraft().imageResources).forEach((t=>{e[t]=Object.assign({},a.getResourcesInDraft().imageResources[t])}));const n=u.appConfigUtils.cleanPortalInfoFromResource(e);return a.uploadImageConfigFileToPortal(n,t)}return Promise.resolve()})):Promise.reject()),(()=>$e(this,void 0,void 0,(function*(){return yield Promise.reject()})))).catch((e=>$e(this,void 0,void 0,(function*(){return yield Promise.reject(e)}))))}))}function Ge(e){return $e(this,void 0,void 0,(function*(){const t=yield function(e){return F(this,void 0,void 0,(function*(){const t=u.SessionManager.getInstance(),n=(new Date).getTime();return window.jimuConfig.isDevEdition?yield window.fetch(`/apps/${e}/resources/config/config.json`).then((e=>F(this,void 0,void 0,(function*(){return yield e.json()})))):yield _(`${u.portalUrlUtils.getPortalRestUrl((0,u.getAppStore)().getState().portalUrl)}/content/items/${e}/resources/config/config.json`,{authentication:t.getSessionByUrl((0,u.getAppStore)().getState().portalUrl),httpMethod:"GET",params:{timestamp:n}}).catch((e=>F(this,void 0,void 0,(function*(){return yield this._handleAuthError(e)}))))}))}(e.id),n=yield Ne(e),r=u.SessionManager.getInstance().getMainSession();if(t&&n){const i=function(e){let t=!1;const n=e.map((e=>e.includes("status:")?(t=!0,`status: ${a.Published}`):e));if(!t){const e=`status: ${a.Published}`;n.push(e)}return n}(null==e?void 0:e.typeKeywords);return u.moduleLoader.getModuleSync("jimu-for-builder").AppResourceManager.getInstance().setAppConfigLocalFileToResource(t).then((t=>$e(this,void 0,void 0,(function*(){if(!t)return yield Promise.reject();t=function(e,t){return t.__not_publish||(e.historyLabels&&(se(e,"pages"),se(e,"views"),se(e,"dialogs")),ae(e,t,"pages"),ae(e,t,"views"),ae(e,t,"dialogs")),e}(t=function(e,t){return Object.values(e.widgets).forEach((e=>{"widgets/common/text/"===e.uri&&function(e,t){if(t.type===s.TemplateType)return e;ue(null==e?void 0:e.text)||delete e.placeholder}(e.config,t)})),e}(t,e),n);const o=function(e){const{type:t,id:n}=e,{isDevEdition:r,isInPortal:i,hostEnv:o}=window.jimuConfig,a=t===s.TemplateType,l=!r&&!i;if(r)return null;let c=u.urlUtils.getAppUrl({appId:n,isTemplate:a});if(l)switch(o){case"prod":c=`https://experience.arcgis.com${c}`;break;case"dev":c=`https://experiencedev.arcgis.com${c}`;break;case"qa":c=`https://experienceqa.arcgis.com${c}`}return i&&(c=`${window.location.origin}${c}`),c}(e);return yield pe({item:{id:e.id,owner:e.owner||(null==r?void 0:r.username),data:t,typeKeywords:i,url:o},authentication:u.SessionManager.getInstance().getMainSession()}).then((()=>$e(this,void 0,void 0,(function*(){return yield Promise.resolve()}))),(()=>$e(this,void 0,void 0,(function*(){return yield Promise.reject()}))))}))),(()=>$e(this,void 0,void 0,(function*(){return yield Promise.reject()})))).catch((e=>$e(this,void 0,void 0,(function*(){return yield Promise.reject(e)}))))}return yield Promise.reject()}))}function Fe(e){return $e(this,void 0,void 0,(function*(){return we(e).then((e=>$e(this,void 0,void 0,(function*(){const t=(null==e?void 0:e.folders)||[];return yield Promise.resolve(t)}))),(e=>$e(this,void 0,void 0,(function*(){return yield Promise.reject(e)}))))}))}function _e(e){return $e(this,void 0,void 0,(function*(){return yield ye(e).then((e=>$e(this,void 0,void 0,(function*(){return yield Promise.resolve(e)}))))}))}function Xe(e){return $e(this,void 0,void 0,(function*(){return yield Ee(e).then((e=>$e(this,void 0,void 0,(function*(){return yield Promise.resolve(e)}))))}))}function Be(e){return $e(this,void 0,void 0,(function*(){return yield Se(e).then((e=>$e(this,void 0,void 0,(function*(){return yield Promise.resolve(e)}))))}))}function qe(e){return $e(this,void 0,void 0,(function*(){return yield function(e){return ce(this,void 0,void 0,(function*(){return yield u.esri.restPortal.moveItem(e)}))}(Object.assign(Object.assign({},e),{authentication:u.SessionManager.getInstance().getMainSession()}))}))}function Ve(e){return $e(this,void 0,void 0,(function*(){return yield function(e){return ce(this,void 0,void 0,(function*(){return yield u.esri.restPortal.getUserTags(e)}))}({username:e,authentication:u.SessionManager.getInstance().getMainSession()})}))}function He(e){return $e(this,void 0,void 0,(function*(){return yield function(e){return ce(this,void 0,void 0,(function*(){return yield u.esri.restPortal.searchGroups(e)}))}(e)}))}function Ke(e){return $e(this,void 0,void 0,(function*(){return(0,Ie.getTemplateConfig)(Ie.TemplateType.App,e.template)}))}function Ye(e){return $e(this,void 0,void 0,(function*(){const t=u.SessionManager.getInstance().getMainSession();return yield function(e){return ce(this,void 0,void 0,(function*(){return he("removeItemResource")(e)}))}(Object.assign(Object.assign({},e),{authentication:t}))}))}function Je(e){return $e(this,void 0,void 0,(function*(){const t=u.SessionManager.getInstance().getMainSession();return yield ge(Object.assign(Object.assign({},e),{authentication:t}))}))}function We(e,t){return $e(this,void 0,void 0,(function*(){const n=u.SessionManager.getInstance().getMainSession();return yield me(e,Object.assign({authentication:n},t))}))}function ze(e){return $e(this,void 0,void 0,(function*(){const t=u.SessionManager.getInstance().getMainSession();return yield function(e){return ce(this,void 0,void 0,(function*(){return he("updateItemResource")(e)}))}(Object.assign(Object.assign({},e),{authentication:t}))}))}var Qe=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))};const Ze=u.esri.restRequest.request;var et;let tt,nt;function rt(e,t){return Qe(this,void 0,void 0,(function*(){const n=u.SessionManager.getInstance().getMainSession(),{username:r}=n,i=(0,u.getAppStore)().getState().portalUrl,o=u.portalUrlUtils.getBaseUserUrl(i),s=yield dt.getInstance().getToken();let a;switch(t=null!=t?t:ct(),e){case et.Add:a=o+"/"+r+"/addResource/?token="+s;break;case et.Remove:a=o+"/"+r+"/removeResource/?token="+s;break;case et.Get:a=o+"/"+r+"/resources/"+t+"?token="+s;break;case et.GetAll:a=o+"/"+r+"/resources/?token="+s}return yield Promise.resolve(a)}))}function it(e,t){return Qe(this,void 0,void 0,(function*(){t=null!=t?t:ct();const n={httpMethod:"POST",params:Object.assign(Object.assign({},e),{key:t,access:"UserPrivateAllApps"})};return yield rt(et.Add).then((e=>Qe(this,void 0,void 0,(function*(){return yield Ze(e,n).then((e=>Qe(this,void 0,void 0,(function*(){return yield Promise.resolve(e)}))))})))).catch((e=>Qe(this,void 0,void 0,(function*(){return yield Promise.reject(new Error("Failed adding user resource:"+e.message))}))))}))}function ot(e){return Qe(this,void 0,void 0,(function*(){return e=null!=e?e:ct(),yield rt(et.Get,e).then((e=>Qe(this,void 0,void 0,(function*(){return yield Ze(e,{params:{f:"json"}}).then((e=>Qe(this,void 0,void 0,(function*(){return yield Promise.resolve(e)}))))})))).catch((e=>Qe(this,void 0,void 0,(function*(){return yield Promise.reject(new Error("Failed retrieving user resource:"+e.message))}))))}))}function st(){return Qe(this,void 0,void 0,(function*(){return yield rt(et.GetAll).then((e=>Qe(this,void 0,void 0,(function*(){return yield Ze(e,{params:{f:"json"}}).then((e=>Qe(this,void 0,void 0,(function*(){return yield Promise.resolve(e)}))))})))).catch((e=>Qe(this,void 0,void 0,(function*(){return yield Promise.reject(new Error("Failed retrieving user resource list:"+e.message))}))))}))}function at(e){return Qe(this,void 0,void 0,(function*(){return e=null!=e?e:ct(),yield rt(et.Remove).then((t=>Qe(this,void 0,void 0,(function*(){const n={params:{key:e}};return yield Ze(t,n).then((e=>Qe(this,void 0,void 0,(function*(){return yield Promise.resolve(e)}))))})))).catch((e=>Qe(this,void 0,void 0,(function*(){return yield Promise.reject(new Error("Failed removing user resource:"+e.message))}))))}))}function lt(e){return Qe(this,void 0,void 0,(function*(){return yield ot().then((t=>Qe(this,void 0,void 0,(function*(){const n=(0,u.Immutable)(null!=t?t:{}).merge(e,{deep:!0});return yield it({text:JSON.stringify(Object.assign({},n))})})))).then((e=>Qe(this,void 0,void 0,(function*(){return yield Promise.resolve(e)})))).catch((e=>Qe(this,void 0,void 0,(function*(){return yield Promise.reject(new Error("Failed updating user resource:"+e.message))}))))}))}function ut(){return Qe(this,void 0,void 0,(function*(){return tt||(tt=st().then((e=>Qe(this,void 0,void 0,(function*(){if(0===e.total)return yield it({text:"{}"});{const t=e.userResources[0],n=ct();return t.key===n?yield Promise.resolve({success:!0}):yield ot(t.key).catch((e=>null)).then((e=>Qe(this,void 0,void 0,(function*(){return e&&(e.showGuides||0===Object.keys(e).length)?yield at(t.key).then((()=>Qe(this,void 0,void 0,(function*(){return yield it({text:JSON.stringify(Object.assign({},e))})})))):yield it({text:"{}"})}))))}})))).catch((e=>Qe(this,void 0,void 0,(function*(){return yield Promise.reject(new Error("Failed initializing user resource:"+e.message))}))))),tt}))}function ct(){if(!nt){const e=u.SessionManager.getInstance().getMainSession();nt=`${u.USER_SETTING_FILE_KEY}${(null==e?void 0:e.clientId)?`_${e.clientId}`:""}.json`}return nt}!function(e){e.Add="ADD",e.Remove="REMOVE",e.Get="GET",e.GetAll="GETALL"}(et||(et={}));class dt{constructor(){this.session=u.SessionManager.getInstance().getMainSession()}static getInstance(){return dt.instance||(dt.instance=new dt),dt.instance}_shouldExchangeToken(){return Qe(this,void 0,void 0,(function*(){if(!this.exchangedToken||this.session.tokenExpires<new Date){if(!this.portalSelfPromise){const e=(0,u.getAppStore)().getState().portalUrl;this.portalSelfPromise=Ze(`${e}/sharing/rest/community/self?token=${this.session.token}`).then((({appInfo:e})=>Qe(this,void 0,void 0,(function*(){return yield Promise.resolve("experienceBuilder"!==(null==e?void 0:e.appId))})))).catch((e=>Qe(this,void 0,void 0,(function*(){return yield Promise.reject(new Error(e.message))}))))}return yield this.portalSelfPromise}return yield Promise.resolve(!1)}))}_exchangeToken(){return Qe(this,void 0,void 0,(function*(){const e=(0,u.getAppStore)().getState().portalUrl+"/sharing/rest/oauth2/exchangeToken",t={params:{client_id:this.session.clientId,token:this.session.token}};return yield Ze(e,t)}))}getToken(){var e;return Qe(this,void 0,void 0,(function*(){return(yield this._shouldExchangeToken())?yield this._exchangeToken().catch((e=>(console.warn("Failed exchanging token. Using default token from user sesion."),{token:this.session.token}))).then((e=>Qe(this,void 0,void 0,(function*(){return this.exchangedToken=null==e?void 0:e.token,yield Promise.resolve(this.exchangedToken)})))):yield Promise.resolve(null!==(e=this.exchangedToken)&&void 0!==e?e:this.session.token)}))}}})(),o})())}}}));